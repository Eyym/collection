<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ajax代码</title>
    <link rel="stylesheet" type="text/css" href="/collection/css/common.css">
    <script src="/collection/js/common.js"></script>
</head>
<body>
<aside></aside>
<article>
    <header>
        <h1>ajax代码</h1>
        <div id="info">
            <span id="time">2018-10-16</span>
            作者：<span id="author"><a href="javascript:myAlert();">loubth</a></span>
        </div>
    </header>
    <div class="content">


        <div>

            <h3>Get请求示例</h3><div><font style="font-family:Microsoft YaHei;font-size:18px;"><pre style="background-color:#000000;color:#d8d8d8;font-family:'宋体';font-size:15pt;">&lt;<span style="color:#60ff60;">script </span><span style="color:#bfa4a4;">type=</span><span style="color:#ffa0a0;">"text/javascript"</span>&gt;<br><span style="color:#757575;">// 创建异步对象<br></span><span style="color:#60ff60;">function </span><span style="font-style:italic;">createXMLHttpRequest</span>() {<br>   <span style="color:#60ff60;">try </span>{<br>      <span style="color:#60ff60;">return new </span><span style="color:#660e7a;font-weight:bold;font-style:italic;">XMLHttpRequest</span>();<span style="color:#757575;">//大多数浏览器<br></span><span style="color:#757575;">   </span>} <span style="color:#60ff60;">catch </span>(e) {<br>      <span style="color:#60ff60;">try </span>{<br>         <span style="color:#60ff60;">return </span>ActvieXObject(<span style="color:#ffa0a0;">"Msxml2.XMLHTTP"</span>);<span style="color:#757575;">//IE6.0<br></span><span style="color:#757575;">      </span>} <span style="color:#60ff60;">catch </span>(e) {<br>         <span style="color:#60ff60;">try </span>{<br>            <span style="color:#60ff60;">return </span>ActvieXObject(<span style="color:#ffa0a0;">"Microsoft.XMLHTTP"</span>);<span style="color:#757575;">//IE5.5及更早版本 <br></span><span style="color:#757575;">         </span>} <span style="color:#60ff60;">catch </span>(e) {<br>            <span style="font-style:italic;">alert</span>(<span style="color:#ffa0a0;">"哥们儿，您用的是什么浏览器啊？"</span>);<br>            <span style="color:#60ff60;">throw </span>e;<br>         }<br>      }<br>   }<br>}<br><br><span style="color:#660e7a;font-weight:bold;font-style:italic;">window</span>.<span style="color:#cfbfad;">onload </span>= <span style="color:#60ff60;">function</span>() {<span style="color:#757575;">//文档加载完毕后执行<br></span><span style="color:#757575;">   </span><span style="color:#60ff60;">var </span><span style="color:#458383;">btn </span>= <span style="color:#660e7a;font-weight:bold;font-style:italic;">document</span>.<span style="color:#7a7a43;">getElementById</span>(<span style="color:#ffa0a0;">"btn"</span>);<br>   <span style="color:#458383;">btn</span>.<span style="color:#cfbfad;">onclick </span>= <span style="color:#60ff60;">function</span>() {<span style="color:#757575;">//给按钮的点击事件注册监听<br></span><span style="color:#757575;">      </span><span style="color:#808080;font-style:italic;">/*<br></span><span style="color:#808080;font-style:italic;">      ajax四步操作，得到服务器的响应<br></span><span style="color:#808080;font-style:italic;">      把响应结果显示到h1元素中<br></span><span style="color:#808080;font-style:italic;">      */<br></span><span style="color:#808080;font-style:italic;">      /*<br></span><span style="color:#808080;font-style:italic;">      1. 得到异步对象 <br></span><span style="color:#808080;font-style:italic;">      */<br></span><span style="color:#808080;font-style:italic;">      </span><span style="color:#60ff60;">var </span><span style="color:#458383;">xmlHttp </span>= <span style="font-style:italic;">createXMLHttpRequest</span>();<br>      <span style="color:#808080;font-style:italic;">/*<br></span><span style="color:#808080;font-style:italic;">      2. 打开与服务器的连接<br></span><span style="color:#808080;font-style:italic;">        * 指定请求方式<br></span><span style="color:#808080;font-style:italic;">        * 指定请求的URL<br></span><span style="color:#808080;font-style:italic;">        * 指定是否为异步请求<br></span><span style="color:#808080;font-style:italic;">      */<br></span><span style="color:#808080;font-style:italic;">      </span><span style="color:#458383;">xmlHttp</span>.<span style="color:#cfbfad;">open</span>(<span style="color:#ffa0a0;">"GET"</span>, <span style="color:#ffa0a0;">"</span>&lt;<span style="color:#cfbfad;">c</span><span style="color:#60ff60;">:url </span><span style="color:#bfa4a4;">value</span><span style="color:#ffa0a0;">='/AServlet'</span>/&gt;<span style="color:#ffa0a0;">"</span>, <span style="color:#60ff60;">true</span>);<br>      <span style="color:#808080;font-style:italic;">/*<br></span><span style="color:#808080;font-style:italic;">      3. 发送请求<br></span><span style="color:#808080;font-style:italic;">      */<br></span><span style="color:#808080;font-style:italic;">      </span><span style="color:#458383;">xmlHttp</span>.<span style="color:#7a7a43;">send</span>(<span style="color:#60ff60;">null</span>);<span style="color:#757575;">//GET请求没有请求体，但也要给出null，不然FireFox可能会不能发送！<br></span><span style="color:#757575;">      </span><span style="color:#808080;font-style:italic;">/*<br></span><span style="color:#808080;font-style:italic;">      4. 给异步对象的onreadystatechange事件注册监听器<br></span><span style="color:#808080;font-style:italic;">      */<br></span><span style="color:#808080;font-style:italic;">      </span><span style="color:#458383;">xmlHttp</span>.<span style="color:#7a7a43;">onreadystatechange </span>= <span style="color:#60ff60;">function</span>() {<span style="color:#757575;">//当xmlHttp的状态发生变化时执行<br></span><span style="color:#757575;">         // 双重判断：xmlHttp的状态为4（服务器响应结束），以及服务器响应的状态码为200（响应成功）<br></span><span style="color:#757575;">         </span><span style="color:#60ff60;">if</span>(<span style="color:#458383;">xmlHttp</span>.<span style="color:#cfbfad;">readyState </span>== <span style="color:#ffa0a0;">4 </span>&amp;&amp; <span style="color:#458383;">xmlHttp</span>.<span style="color:#cfbfad;">status </span>== <span style="color:#ffa0a0;">200</span>) {<br>            <span style="color:#757575;">// 获取服务器的响应结束<br></span><span style="color:#757575;">            </span><span style="color:#60ff60;">var </span><span style="color:#458383;">text </span>= <span style="color:#458383;">xmlHttp</span>.<span style="color:#cfbfad;">responseText</span>;<br>            <span style="color:#757575;">// 获取h1元素<br></span><span style="color:#757575;">            </span><span style="color:#60ff60;">var </span><span style="color:#458383;">h1 </span>= <span style="color:#660e7a;font-weight:bold;font-style:italic;">document</span>.<span style="color:#7a7a43;">getElementById</span>(<span style="color:#ffa0a0;">"h1"</span>);<br>            <span style="color:#458383;">h1</span>.<span style="color:#cfbfad;">innerHTML </span>= <span style="color:#458383;">text</span>;<br>         }<br>      };<br>   };<br>};<br>&lt;/<span style="color:#60ff60;">script</span>&gt;</pre></font></div><div><h3>Post请求示例</h3></div><div><font style="font-family:Microsoft YaHei;font-size:18px;"><pre style="background-color:#000000;color:#d8d8d8;font-family:'宋体';font-size:15pt;">&lt;<span style="color:#60ff60;">script </span><span style="color:#bfa4a4;">type=</span><span style="color:#ffa0a0;">"text/javascript"</span>&gt;<br><span style="color:#757575;">// 创建异步对象<br></span><span style="color:#60ff60;">function </span><span style="font-style:italic;">createXMLHttpRequest</span>() {<br>   <span style="color:#60ff60;">try </span>{<br>      <span style="color:#60ff60;">return new </span><span style="color:#660e7a;font-weight:bold;font-style:italic;">XMLHttpRequest</span>();<span style="color:#757575;">//大多数浏览器<br></span><span style="color:#757575;">   </span>} <span style="color:#60ff60;">catch </span>(e) {<br>      <span style="color:#60ff60;">try </span>{<br>         <span style="color:#60ff60;">return </span>ActvieXObject(<span style="color:#ffa0a0;">"Msxml2.XMLHTTP"</span>);<span style="color:#757575;">//IE6.0<br></span><span style="color:#757575;">      </span>} <span style="color:#60ff60;">catch </span>(e) {<br>         <span style="color:#60ff60;">try </span>{<br>            <span style="color:#60ff60;">return </span>ActvieXObject(<span style="color:#ffa0a0;">"Microsoft.XMLHTTP"</span>);<span style="color:#757575;">//IE5.5及更早版本 <br></span><span style="color:#757575;">         </span>} <span style="color:#60ff60;">catch </span>(e) {<br>            <span style="font-style:italic;">alert</span>(<span style="color:#ffa0a0;">"哥们儿，您用的是什么浏览器啊？"</span>);<br>            <span style="color:#60ff60;">throw </span>e;<br>         }<br>      }<br>   }<br>}<br><br><span style="color:#660e7a;font-weight:bold;font-style:italic;">window</span>.<span style="color:#cfbfad;">onload </span>= <span style="color:#60ff60;">function</span>() {<span style="color:#757575;">//文档加载完毕后执行<br></span><span style="color:#757575;">   </span><span style="color:#60ff60;">var </span><span style="color:#458383;">btn </span>= <span style="color:#660e7a;font-weight:bold;font-style:italic;">document</span>.<span style="color:#7a7a43;">getElementById</span>(<span style="color:#ffa0a0;">"btn"</span>);<br>   <span style="color:#458383;">btn</span>.<span style="color:#cfbfad;">onclick </span>= <span style="color:#60ff60;">function</span>() {<span style="color:#757575;">//给按钮的点击事件注册监听<br></span><span style="color:#757575;">      </span><span style="color:#808080;font-style:italic;">/*<br></span><span style="color:#808080;font-style:italic;">      ajax四步操作，得到服务器的响应<br></span><span style="color:#808080;font-style:italic;">      把响应结果显示到h1元素中<br></span><span style="color:#808080;font-style:italic;">      */<br></span><span style="color:#808080;font-style:italic;">      /*<br></span><span style="color:#808080;font-style:italic;">      1. 得到异步对象 <br></span><span style="color:#808080;font-style:italic;">      */<br></span><span style="color:#808080;font-style:italic;">      </span><span style="color:#60ff60;">var </span><span style="color:#458383;">xmlHttp </span>= <span style="font-style:italic;">createXMLHttpRequest</span>();<br>      <span style="color:#808080;font-style:italic;">/*<br></span><span style="color:#808080;font-style:italic;">      2. 打开与服务器的连接<br></span><span style="color:#808080;font-style:italic;">        * 指定请求方式<br></span><span style="color:#808080;font-style:italic;">        * 指定请求的URL<br></span><span style="color:#808080;font-style:italic;">        * 指定是否为异步请求<br></span><span style="color:#808080;font-style:italic;">      */<br></span><span style="color:#808080;font-style:italic;">      </span><span style="color:#757575;">/************修改open方法，指定请求方式为POST**************/<br></span><span style="color:#757575;">      </span><span style="color:#458383;">xmlHttp</span>.<span style="color:#cfbfad;">open</span>(<span style="color:#ffa0a0;">"POST"</span>, <span style="color:#ffa0a0;">"</span>&lt;<span style="color:#cfbfad;">c</span><span style="color:#60ff60;">:url </span><span style="color:#bfa4a4;">value</span><span style="color:#ffa0a0;">='/AServlet'</span>/&gt;<span style="color:#ffa0a0;">"</span>, <span style="color:#60ff60;">true</span>);<br>      <span style="color:#757575;">/************设置请求头：Content-Type************/<br></span><span style="color:#757575;">      </span><span style="color:#458383;">xmlHttp</span>.<span style="color:#7a7a43;">setRequestHeader</span>(<span style="color:#ffa0a0;">"Content-Type"</span>, <span style="color:#ffa0a0;">"application/x-www-form-urlencoded"</span>);<br>      <span style="color:#808080;font-style:italic;">/*<br></span><span style="color:#808080;font-style:italic;">      3. 发送请求<br></span><span style="color:#808080;font-style:italic;">      */<br></span><span style="color:#808080;font-style:italic;">      </span><span style="color:#757575;">/**********发送时指定请求体***********/<br></span><span style="color:#757575;">      </span><span style="color:#458383;">xmlHttp</span>.<span style="color:#7a7a43;">send</span>(<span style="color:#ffa0a0;">"username=张三&amp;password=123"</span>);<span style="color:#757575;">//GET请求没有请求体，但也要给出null，不然FireFox可能会不能发送！<br></span><span style="color:#757575;">      </span><span style="color:#808080;font-style:italic;">/*<br></span><span style="color:#808080;font-style:italic;">      4. 给异步对象的onreadystatechange事件注册监听器<br></span><span style="color:#808080;font-style:italic;">      */<br></span><span style="color:#808080;font-style:italic;">      </span><span style="color:#458383;">xmlHttp</span>.<span style="color:#7a7a43;">onreadystatechange </span>= <span style="color:#60ff60;">function</span>() {<span style="color:#757575;">//当xmlHttp的状态发生变化时执行<br></span><span style="color:#757575;">         // 双重判断：xmlHttp的状态为4（服务器响应结束），以及服务器响应的状态码为200（响应成功）<br></span><span style="color:#757575;">         </span><span style="color:#60ff60;">if</span>(<span style="color:#458383;">xmlHttp</span>.<span style="color:#cfbfad;">readyState </span>== <span style="color:#ffa0a0;">4 </span>&amp;&amp; <span style="color:#458383;">xmlHttp</span>.<span style="color:#cfbfad;">status </span>== <span style="color:#ffa0a0;">200</span>) {<br>            <span style="color:#757575;">// 获取服务器的响应结束<br></span><span style="color:#757575;">            </span><span style="color:#60ff60;">var </span><span style="color:#458383;">text </span>= <span style="color:#458383;">xmlHttp</span>.<span style="color:#cfbfad;">responseText</span>;<br>            <span style="color:#757575;">// 获取h1元素<br></span><span style="color:#757575;">            </span><span style="color:#60ff60;">var </span><span style="color:#458383;">h1 </span>= <span style="color:#660e7a;font-weight:bold;font-style:italic;">document</span>.<span style="color:#7a7a43;">getElementById</span>(<span style="color:#ffa0a0;">"h1"</span>);<br>            <span style="color:#458383;">h1</span>.<span style="color:#cfbfad;">innerHTML </span>= <span style="color:#458383;">text</span>;<br>         }<br>      };<br>   };<br>};<br>&lt;/<span style="color:#60ff60;">script</span>&gt;</pre></font></div>


        </div>


    </div>
</article>
<footer></footer>
</body>
</html>
