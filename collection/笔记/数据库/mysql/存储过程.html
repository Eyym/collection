<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>存储过程</title>
    <link rel="stylesheet" type="text/css" href="/collection/css/common.css">
    <link rel="stylesheet" type="text/css" href="/collection/css/Syntaxhighlighter/shCoreMDUltra.css"/>
    <script src="https://cdn.bootcss.com/jquery/1.9.1/jquery.min.js"></script>
    <script src="/collection/js/common.js"></script>
</head>
<body>
<aside class="k-catelog-list" id="catelog-list"></aside>
<article>
    <header>
        <h1>存储过程</h1>
        <div id="info">
            <div id="time">2019-06-26</div>
            <div id="author">作者：<span><a href="javascript:myAlert();">loubth</a></span></div>
        </div>
    </header>
    <div id="k-catelog" class="content doc">

        <h2>概念</h2>
        <p>存储过程（stored
            procedure），简称过程，是在大型数据库系统中一组为了完成特定功能的SQL语句集，存储在数据库中，经过第一次编译后再次调用不需要再次编译（效率比较高），用户通过指定存储过程的名字并给出参数（如果该存储过程带有参数）来执行它。存储过程是数据库中的一个重要对象（针对SQL编程而言）</p>

        <h2>与函数的区别</h2>
        <h3>相同点</h3>
        <ol>
            <li>存储过程和函数目的都是为了可重复地执行操作数据库的SQL语句的集合</li>
            <li>存储过程函数都是一次编译，后续执行</li>
        </ol>
        <h3>不同点</h3>
        <ol>
            <li>标识符不同。函数的标识符为function，过程为：procedure</li>
            <li>函数中有返回值，且必须返回，而过程没有返回值</li>
            <li>过程无返回值类型，不能将结果直接赋值给变量；函数有返回值类型，调用时，除在select中，必须将返回值赋给变量</li>
            <li>函数可以在select语句中直接使用，而过程不能：函数是使用select调用，过程不是</li>
        </ol>


        <h2>存储过程操作</h2>
        <h3>创建过程</h3>
        <p><em>基本语法</em></p>
        <div id="highlighter_156714" class="syntaxhighlighter nogutter  xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">create&nbsp;procedure&nbsp;过程名字([参数列表])</code></div><div class="line number2 index1 alt1"><code class="xml plain">begin</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">过程体</code></div><div class="line number4 index3 alt1"><code class="xml plain">end</code></div><div class="line number5 index4 alt2"><code class="xml plain">结束符</code></div></div></td></tr></tbody></table>
        </div>
        <p>如果过程体中只有一条指令，那么可以省略begin和end</p>
        <p>示例</p>
        <div id="highlighter_771641" class="syntaxhighlighter  xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">mysql&gt;&nbsp;create&nbsp;procedure&nbsp;my_pro1()</code></div><div class="line number2 index1 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;&nbsp;select&nbsp;*&nbsp;from&nbsp;my_student;</code></div><div class="line number3 index2 alt2"><code class="xml plain">Query&nbsp;OK,&nbsp;0&nbsp;rows&nbsp;affected&nbsp;(0.12&nbsp;sec)</code></div></div></td></tr></tbody></table>
        </div>
        <p>示例</p>
        <div id="highlighter_422834" class="syntaxhighlighter  xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">--&nbsp;修改语句结束符</code></div><div class="line number2 index1 alt1"><code class="xml plain">delimiter&nbsp;$$</code></div><div class="line number3 index2 alt2"><code class="xml plain">create&nbsp;procedure&nbsp;my_pro2()</code></div><div class="line number4 index3 alt1"><code class="xml plain">begin</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">--&nbsp;求1到100之间的和</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">declare&nbsp;i&nbsp;int&nbsp;default&nbsp;1;</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">--&nbsp;declare&nbsp;sum&nbsp;int&nbsp;default&nbsp;0;&nbsp;&nbsp;--&nbsp;局部变量，我们此次不用局部变量，尝试使用会话变量</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">set @sum=0;&nbsp;&nbsp;--&nbsp;会话变量</code></div><div class="line number9 index8 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">--&nbsp;开始循环获取结果</code></div><div class="line number10 index9 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">while&nbsp;i&nbsp;&lt;=&nbsp;100&nbsp;do</code></div><div class="line number11 index10 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">--&nbsp;求和</code></div><div class="line number12 index11 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">set&nbsp;@sum&nbsp;=&nbsp;@sum&nbsp;+&nbsp;i;</code></div><div class="line number13 index12 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">set&nbsp;i&nbsp;=&nbsp;i&nbsp;+&nbsp;1;</code></div><div class="line number14 index13 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">end&nbsp;while;</code></div><div class="line number15 index14 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">--&nbsp;显示结果</code></div><div class="line number16 index15 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">select&nbsp;@sum;</code></div><div class="line number17 index16 alt2"><code class="xml plain">end</code></div><div class="line number18 index17 alt1"><code class="xml plain">$$</code></div><div class="line number19 index18 alt2"><code class="xml plain">delimiter&nbsp;;</code></div></div></td></tr></tbody></table>
        </div>



        <h3>查看过程</h3>

        <p><em>查看全部存储过程</em>：<strong>show procedure status [like 'pattern'];</strong></p>
        <div id="highlighter_82262" class="syntaxhighlighter  xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">mysql&gt;&nbsp;show&nbsp;procedure&nbsp;status\G</code></div><div class="line number2 index1 alt1"><code class="xml plain">***************************&nbsp;1.&nbsp;row&nbsp;***************************</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">Db:&nbsp;mydatabase</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">Name:&nbsp;my_pro1</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">Type:&nbsp;PROCEDURE</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">Definer:&nbsp;root@localhost</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">Modified:&nbsp;2019-06-26&nbsp;08:27:09</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">Created:&nbsp;2019-06-26&nbsp;08:27:09</code></div><div class="line number9 index8 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">Security_type:&nbsp;DEFINER</code></div><div class="line number10 index9 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">Comment:</code></div><div class="line number11 index10 alt2"><code class="xml plain">character_set_client:&nbsp;utf8</code></div><div class="line number12 index11 alt1"><code class="xml plain">collation_connection:&nbsp;utf8_general_ci</code></div><div class="line number13 index12 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">Database&nbsp;Collation:&nbsp;utf8_general_ci</code></div><div class="line number14 index13 alt1"><code class="xml plain">***************************&nbsp;2.&nbsp;row&nbsp;***************************</code></div><div class="line number15 index14 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">Db:&nbsp;mydatabase</code></div><div class="line number16 index15 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">Name:&nbsp;my_pro2</code></div><div class="line number17 index16 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">Type:&nbsp;PROCEDURE</code></div><div class="line number18 index17 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">Definer:&nbsp;root@localhost</code></div><div class="line number19 index18 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">Modified:&nbsp;2019-06-26&nbsp;08:35:52</code></div><div class="line number20 index19 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">Created:&nbsp;2019-06-26&nbsp;08:35:52</code></div><div class="line number21 index20 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">Security_type:&nbsp;DEFINER</code></div><div class="line number22 index21 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">Comment:</code></div><div class="line number23 index22 alt2"><code class="xml plain">character_set_client:&nbsp;utf8</code></div><div class="line number24 index23 alt1"><code class="xml plain">collation_connection:&nbsp;utf8_general_ci</code></div><div class="line number25 index24 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">Database&nbsp;Collation:&nbsp;utf8_general_ci</code></div><div class="line number26 index25 alt1"><code class="xml plain">***************************&nbsp;3.&nbsp;row&nbsp;***************************</code></div><div class="line number27 index26 alt2">&nbsp;</div><div class="line number28 index27 alt1"><code class="xml plain">--&nbsp;后面太长故省略</code></div></div></td></tr></tbody></table>
        </div>
        <p><em>查看存储过程定义</em>：<strong>show create procedure <em>过程名</em>\G</strong></p>
        <div id="highlighter_934982" class="syntaxhighlighter  xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">mysql&gt;&nbsp;show&nbsp;create&nbsp;procedure&nbsp;my_pro2\G</code></div><div class="line number2 index1 alt1"><code class="xml plain">***************************&nbsp;1.&nbsp;row&nbsp;***************************</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">Procedure:&nbsp;my_pro2</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">sql_mode:&nbsp;ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">Create&nbsp;Procedure:&nbsp;CREATE&nbsp;DEFINER=`root`@`localhost`&nbsp;PROCEDURE&nbsp;`my_pro2`()</code></div><div class="line number6 index5 alt1"><code class="xml plain">begin</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="xml plain">declare&nbsp;i&nbsp;int&nbsp;default&nbsp;1;</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="xml plain">set @sum=0;</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="xml plain">while&nbsp;i&nbsp;&lt;=&nbsp;100&nbsp;do</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="xml plain">set @sum&nbsp;=&nbsp;@sum&nbsp;+&nbsp;i;</code></div><div class="line number15 index14 alt2"><code class="xml plain">set&nbsp;i&nbsp;=&nbsp;i&nbsp;+&nbsp;1;</code></div><div class="line number16 index15 alt1"><code class="xml plain">end&nbsp;while;</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="xml plain">select&nbsp;@sum;</code></div><div class="line number19 index18 alt2"><code class="xml plain">end</code></div><div class="line number20 index19 alt1"><code class="xml plain">character_set_client:&nbsp;utf8</code></div><div class="line number21 index20 alt2"><code class="xml plain">collation_connection:&nbsp;utf8_general_ci</code></div><div class="line number22 index21 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">Database&nbsp;Collation:&nbsp;utf8_general_ci</code></div><div class="line number23 index22 alt2"><code class="xml plain">1&nbsp;row&nbsp;in&nbsp;set&nbsp;(0.00&nbsp;sec)</code></div></div></td></tr></tbody></table>
        </div>


        <h3>调用过程</h3>
        <p>存储过程没有返回值，所以不能用欧冠select调用，调用过程有专门的语法</p>
        <p><em>基本语法</em>：<strong>call <em>过程名</em>([<em>实参列表</em>]);</strong></p>
        <p>示例</p>
        <div id="highlighter_3753" class="syntaxhighlighter  xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">mysql&gt;&nbsp;call&nbsp;my_pro2();</code></div><div class="line number2 index1 alt1"><code class="xml plain">+------+</code></div><div class="line number3 index2 alt2"><code class="xml plain">|&nbsp;@sum&nbsp;|</code></div><div class="line number4 index3 alt1"><code class="xml plain">+------+</code></div><div class="line number5 index4 alt2"><code class="xml plain">|&nbsp;5050&nbsp;|</code></div><div class="line number6 index5 alt1"><code class="xml plain">+------+</code></div><div class="line number7 index6 alt2"><code class="xml plain">1&nbsp;row&nbsp;in&nbsp;set&nbsp;(0.01&nbsp;sec)</code></div></div></td></tr></tbody></table>
        </div>


        <h3>删除过程</h3>
        <p><em>基本语法</em>：<strong>drop procedure <em>过程名</em>;</strong></p>
        <p>示例</p>
        <div id="highlighter_233230" class="syntaxhighlighter  xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">mysql&gt;&nbsp;drop&nbsp;procedure&nbsp;my_pro2;</code></div><div class="line number2 index1 alt1"><code class="xml plain">Query&nbsp;OK,&nbsp;0&nbsp;rows&nbsp;affected&nbsp;(0.08&nbsp;sec)</code></div></div></td></tr></tbody></table>
        </div>


        <h2>存储过程的形参类型</h2>
        <p>存储过程也允许提供参数（形参和实参），存储的参数也和函数一样，需要指定其类型</p>
        <p>但是存储过程对参数还有额外的要求：自己的参数分类</p>
        <h3>in</h3>
        <p>表示参数从外部传入到里面使用（过程内部使用）：可以是直接数据也可以是保存数据的变量</p>

        <h3>out</h3>
        <p>表示参数是从过程里面把数据保存到变量中，交给外部使用：传入的必须是变量，如果说传入的out变量本身在外部有数据，那么在进入过程之后，第一件事就是被清空，设为NULL</p>

        <h3>inout</h3>
        <p>数据可以从外部传入到过程内部使用，同时内部操作之后，又会将数据返还给外部</p>


        <p>示例</p>
        <div id="highlighter_122266" class="syntaxhighlighter  xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">mysql&gt;&nbsp;--&nbsp;创建三个外部变量</code></div><div class="line number2 index1 alt1"><code class="xml plain">mysql&gt;&nbsp;set&nbsp;@n1&nbsp;=&nbsp;1;</code></div><div class="line number3 index2 alt2"><code class="xml plain">Query&nbsp;OK,&nbsp;0&nbsp;rows&nbsp;affected&nbsp;(0.00&nbsp;sec)</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;</code>&nbsp;</div><div class="line number5 index4 alt2"><code class="xml plain">mysql&gt;&nbsp;set&nbsp;@n2&nbsp;=&nbsp;2;</code></div><div class="line number6 index5 alt1"><code class="xml plain">Query&nbsp;OK,&nbsp;0&nbsp;rows&nbsp;affected&nbsp;(0.00&nbsp;sec)</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;</code>&nbsp;</div><div class="line number8 index7 alt1"><code class="xml plain">mysql&gt;&nbsp;set&nbsp;@n3&nbsp;=&nbsp;3;</code></div><div class="line number9 index8 alt2"><code class="xml plain">Query&nbsp;OK,&nbsp;0&nbsp;rows&nbsp;affected&nbsp;(0.00&nbsp;sec)</code></div><div class="line number10 index9 alt1"><code class="xml spaces">&nbsp;</code>&nbsp;</div><div class="line number11 index10 alt2"><code class="xml plain">mysql&gt;</code></div><div class="line number12 index11 alt1"><code class="xml plain">mysql&gt;&nbsp;--&nbsp;创建过程</code></div><div class="line number13 index12 alt2"><code class="xml plain">mysql&gt;</code></div><div class="line number14 index13 alt1"><code class="xml plain">mysql&gt;&nbsp;--&nbsp;修改语句结束符</code></div><div class="line number15 index14 alt2"><code class="xml plain">mysql&gt;&nbsp;delimiter&nbsp;$$</code></div><div class="line number16 index15 alt1"><code class="xml plain">mysql&gt;&nbsp;create&nbsp;procedure&nbsp;my_pro3(in&nbsp;int_1&nbsp;int,out&nbsp;int_2&nbsp;int,inout&nbsp;int_3&nbsp;int)</code></div><div class="line number17 index16 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;&nbsp;begin</code></div><div class="line number18 index17 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;</code></div><div class="line number19 index18 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;&nbsp;--&nbsp;查看三个传入进来的数据的值</code></div><div class="line number20 index19 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;&nbsp;select&nbsp;int_1,int_2,int_3;</code></div><div class="line number21 index20 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;</code></div><div class="line number22 index21 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;&nbsp;--&nbsp;修改三个变量的值</code></div><div class="line number23 index22 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;&nbsp;set&nbsp;int_1&nbsp;=&nbsp;10;</code></div><div class="line number24 index23 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;&nbsp;set&nbsp;int_2&nbsp;=&nbsp;100;</code></div><div class="line number25 index24 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;&nbsp;set&nbsp;int_3&nbsp;=&nbsp;1000;</code></div><div class="line number26 index25 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;</code></div><div class="line number27 index26 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;&nbsp;select&nbsp;int_1,int_2,int_3;</code></div><div class="line number28 index27 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;</code></div><div class="line number29 index28 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;&nbsp;--&nbsp;查看会话变量</code></div><div class="line number30 index29 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;&nbsp;select&nbsp;@n1,@n2,@n3;</code></div><div class="line number31 index30 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;</code></div><div class="line number32 index31 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;&nbsp;--&nbsp;修改会话变量</code></div><div class="line number33 index32 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;&nbsp;set&nbsp;@n1&nbsp;=&nbsp;'a';</code></div><div class="line number34 index33 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;&nbsp;set&nbsp;@n2&nbsp;=&nbsp;'b';</code></div><div class="line number35 index34 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;&nbsp;set&nbsp;@n3&nbsp;=&nbsp;'c';</code></div><div class="line number36 index35 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;</code></div><div class="line number37 index36 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;&nbsp;select&nbsp;@n1,@n2,@n3;</code></div><div class="line number38 index37 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;</code></div><div class="line number39 index38 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;&nbsp;end</code></div><div class="line number40 index39 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">-&gt;&nbsp;$$</code></div><div class="line number41 index40 alt2"><code class="xml plain">Query&nbsp;OK,&nbsp;0&nbsp;rows&nbsp;affected&nbsp;(0.02&nbsp;sec)</code></div><div class="line number42 index41 alt1"><code class="xml spaces">&nbsp;</code>&nbsp;</div><div class="line number43 index42 alt2"><code class="xml plain">mysql&gt;&nbsp;delimiter&nbsp;;</code></div><div class="line number44 index43 alt1"><code class="xml plain">mysql&gt;</code></div><div class="line number45 index44 alt2"><code class="xml plain">mysql&gt;</code></div><div class="line number46 index45 alt1"><code class="xml plain">mysql&gt;&nbsp;--&nbsp;----------------调用过程----------------</code></div><div class="line number47 index46 alt2"><code class="xml plain">mysql&gt;&nbsp;call&nbsp;my_pro3(@n1,@n2,@n3);</code></div><div class="line number48 index47 alt1"><code class="xml plain">+-------+-------+-------+</code></div><div class="line number49 index48 alt2"><code class="xml plain">|&nbsp;int_1&nbsp;|&nbsp;int_2&nbsp;|&nbsp;int_3&nbsp;|</code></div><div class="line number50 index49 alt1"><code class="xml plain">+-------+-------+-------+</code></div><div class="line number51 index50 alt2"><code class="xml plain">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;|&nbsp;&nbsp;NULL&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;|</code></div><div class="line number52 index51 alt1"><code class="xml plain">+-------+-------+-------+</code></div><div class="line number53 index52 alt2"><code class="xml plain">1&nbsp;row&nbsp;in&nbsp;set&nbsp;(0.01&nbsp;sec)</code></div><div class="line number54 index53 alt1"><code class="xml spaces">&nbsp;</code>&nbsp;</div><div class="line number55 index54 alt2"><code class="xml plain">+-------+-------+-------+</code></div><div class="line number56 index55 alt1"><code class="xml plain">|&nbsp;int_1&nbsp;|&nbsp;int_2&nbsp;|&nbsp;int_3&nbsp;|</code></div><div class="line number57 index56 alt2"><code class="xml plain">+-------+-------+-------+</code></div><div class="line number58 index57 alt1"><code class="xml plain">|&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;|&nbsp;&nbsp;&nbsp;100&nbsp;|&nbsp;&nbsp;1000&nbsp;|</code></div><div class="line number59 index58 alt2"><code class="xml plain">+-------+-------+-------+</code></div><div class="line number60 index59 alt1"><code class="xml plain">1&nbsp;row&nbsp;in&nbsp;set&nbsp;(0.02&nbsp;sec)</code></div><div class="line number61 index60 alt2"><code class="xml spaces">&nbsp;</code>&nbsp;</div><div class="line number62 index61 alt1"><code class="xml plain">+------+------+------+</code></div><div class="line number63 index62 alt2"><code class="xml plain">|&nbsp;@n1&nbsp;&nbsp;|&nbsp;@n2&nbsp;&nbsp;|&nbsp;@n3&nbsp;&nbsp;|</code></div><div class="line number64 index63 alt1"><code class="xml plain">+------+------+------+</code></div><div class="line number65 index64 alt2"><code class="xml plain">|&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;|</code></div><div class="line number66 index65 alt1"><code class="xml plain">+------+------+------+</code></div><div class="line number67 index66 alt2"><code class="xml plain">1&nbsp;row&nbsp;in&nbsp;set&nbsp;(0.04&nbsp;sec)</code></div><div class="line number68 index67 alt1"><code class="xml spaces">&nbsp;</code>&nbsp;</div><div class="line number69 index68 alt2"><code class="xml plain">+------+------+------+</code></div><div class="line number70 index69 alt1"><code class="xml plain">|&nbsp;@n1&nbsp;&nbsp;|&nbsp;@n2&nbsp;&nbsp;|&nbsp;@n3&nbsp;&nbsp;|</code></div><div class="line number71 index70 alt2"><code class="xml plain">+------+------+------+</code></div><div class="line number72 index71 alt1"><code class="xml plain">|&nbsp;a&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;b&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;c&nbsp;&nbsp;&nbsp;&nbsp;|</code></div><div class="line number73 index72 alt2"><code class="xml plain">+------+------+------+</code></div><div class="line number74 index73 alt1"><code class="xml plain">1&nbsp;row&nbsp;in&nbsp;set&nbsp;(0.05&nbsp;sec)</code></div><div class="line number75 index74 alt2"><code class="xml spaces">&nbsp;</code>&nbsp;</div><div class="line number76 index75 alt1"><code class="xml plain">Query&nbsp;OK,&nbsp;0&nbsp;rows&nbsp;affected&nbsp;(0.06&nbsp;sec)</code></div><div class="line number77 index76 alt2">&nbsp;</div><div class="line number78 index77 alt1"><code class="xml plain">mysql&gt;&nbsp;&nbsp;--&nbsp;----------------查看@n1,@n2,@n3的值----------------</code></div><div class="line number79 index78 alt2"><code class="xml plain">mysql&gt;&nbsp;&nbsp;select&nbsp;@n1,@n2,@n3;</code></div><div class="line number80 index79 alt1"><code class="xml plain">+------+------+------+</code></div><div class="line number81 index80 alt2"><code class="xml plain">|&nbsp;@n1&nbsp;&nbsp;|&nbsp;@n2&nbsp;&nbsp;|&nbsp;@n3&nbsp;&nbsp;|</code></div><div class="line number82 index81 alt1"><code class="xml plain">+------+------+------+</code></div><div class="line number83 index82 alt2"><code class="xml plain">|&nbsp;a&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;100&nbsp;|&nbsp;1000&nbsp;|</code></div><div class="line number84 index83 alt1"><code class="xml plain">+------+------+------+</code></div><div class="line number85 index84 alt2"><code class="xml plain">1&nbsp;row&nbsp;in&nbsp;set&nbsp;(0.00&nbsp;sec)</code></div></div></td></tr></tbody></table>
        </div>
        <p><em>分析结果</em>：</p>
        <p>我们看到五个结果，第一个结果中，int_2的值之所以为NUll就是因为它是out类型的参数，会在传入时清空原数据。第二三四个结果都理所当然，不再赘述。第五个结果中，@n1的值可以理解，@n2和@n3的值怎么解释呢？这时我们就要注意形参的类型了，@n1、@n2和@n3都是存储过程的实参，@n2是out型，@n3是inout型，它们都会将结果值传出过程体的（C#好像也有类似的参数类型），可以在begin和end结构体的末尾脑补两个语句“<strong>@n2=int_2</strong>”和“<strong>@n3=int_3</strong>”</p>



    </div>
</article>
<footer></footer>
</body>
</html>
